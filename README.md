# REACT v18 ПОРТФОЛИО

## ИНТРО

Проект представляет собой SPA на React 18(Create React App + TypeScript + SCSS) с использованием публичного IGDB API. Не использовал готовых компонентов(кроме некоторых utility-библиотек), стилей или помощи от ИИ-чатов. Дизайн тоже набросал сам по ходу работы. Стараюсь реализовать все типовые задачи, встречающиеся на коммерческих проектах, например: слайдер, табы, пагинация, роутинг, модалки и т.д. Минимальная ширина экрана 768px.

## АВТОРИЗАЦИЯ

Авторизация основана на Firebase. Все настройки и нужные функции хранятся в `/src/firebase`. Данные о пользователе прокидываются на все страницы через контекст `AuthContext`. В профиле пользователя можно обновить имя и аватарку. Страница профиля перенаправляет неавторизованного пользователя на страницу с ошибкой `AuthError.tsx`.

## РОУТИНГ

Роутинг построен на React-router-dom v6. Все настройки в `/AppRouter.tsx`. Есть страница 404.

## API.TS

### getData()

Промис, который создаёт тело запроса из пришедших аргументов и отправляет на сервер. Опциональная переменная `signal` используется для отмены запроса.
Пример отправляемой строки: `fields name,cover.image_id,videos.*,screenshots.*,aggregated_rating; limit 6; sort first_release_date desc; where aggregated_rating > 0;`

### getDataCount()

Промис для получения количества элементов по выбранному эндпоинту с нужными настройками фильтрации. Пример тела запроса: `where genre = 2`.

### getCategories()

Получение названий и id категорий.

## HOOKS

### useGetData()

Получает и возвращает данные с сервера. Также возвращает индикатор загрузки и объект с ошибкой `TError`. Используется `AbortController` для сброса неактуальных запросов.

### useSearch()

Получает поисковую строку и делает запрос к серверу через `getData` с использованием debounce в 300мс. Возвращает данные, объект с ошибкой и вспомогательные стейты: `isLoading`, `isSearching`.

### useOutsideClick()

Простой хук для отслеживания клика за пределами переданного элемента.

### usePaginationData()

Подготавливает и возвращает данные для пагинации: кол-во страниц и номер текущей страницы, добытый из хэша. Для подсчёта страниц получаем кол-во элементов из базы данных через `getDataCount` и делим с округлением на кол-во элементов на одной странице(переменная `fetchLimit`, по умолчанию равна 100).

## МОДАЛЬНЫЕ ОКНА(Modal.tsx)

Модальные окна вставляются через портал в `body` и имеют свой контекст `ModalContext`, который пробрасывает внутрь переменную `isOpened`. Чтобы получить стандартное окно, содержимое модалки можно обернуть в `DefaultModalBlock`.

## ПОИСК(SearchBar.tsx)

Данные получаются через хук `useSearch`. Если загрузка завершилась, но ничего не найдено и нет ошибки, то показывается плашка "No games found". В противном случае выводится сообщение об ошибке, пришедшее из fetch-запроса.

Функция `onReset` используется для кнопки сброса, а также вызывается при смене страницы. Очищает объект с данными и сбрасывает состояние поиска(стейт `isSearching`).

При сабмите формы перекидывает на страницу `Search.tsx`, где из хэша достаётся поисковая строка и делается новый запрос с последующим выводом данных на 500 элементов.

## ТАБЫ(Tabs.tsx)

Табы свёрстаны на гридах с наслоением элементов для анимации. Анимация работает за счёт добавления/удаления определённых классов, которые через `translate` смещают табы в нужном направлении:

- `.displayed` активный таб с `translate(0%)`;
- `.pos-left` таб находится слева от активного с `translate(-50%, 0%)`;
- `.pos-right` таб находится справа от активного с `translate(50%, 0%)`;
- `.move-out_left` при смене табов, вешается на активный таб и он уходит влево с `translate(-150%, -5%)` и `scale(5%)`;
- `.move-out_right` при смене табов, вешается на активный таб и он уходит вправо с `translate(150%, -5%)` и `scale(5%)`;

Если id(порядковый номер) выбранного таба меньше id активного таба, то активный уходит вправо(на него вешается `.move-out_right`). В противном случае - влево.

В проп `tabs` передаётся массив с заголовками табов. Все вставленные внутрь компонента child-элементы превращаются в табы, оборачиваясь в `div` с добавлением нужных классов. Следует следить чтобы табы шли в том же порядке, что и в массиве `tabs`.

В функцию `toggleTab` вставлен `setTimeout` на 200мс, который не даёт скрыть таб до завершения анимации.
